
<!DOCTYPE html>
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Supported Topologies | aem-monitoring</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
		
		<link href="./css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />
		<link href="./css/site.css" rel="stylesheet" />
		
		<link href="http://yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

		<!-- Google Analytics -->
		<script type="text/javascript">
		
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-99868238-1']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();

		</script>
		</head>

	<body class="page-topologies project-aem-monitoring" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<nav class="navbar navbar-default navbar-fixed-top">
				<div class="container">
					<div class="navbar-header">
				      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
				        <span class="sr-only">Toggle navigation</span>
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				      </button>
				    
					<a class="navbar-brand" href="index.html">AEM Monitoring</a>
					</div>
					<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav navbar-right">
							<li><a href="https://github.com/OlsonDigital/aem-monitoring" title="GitHub" class="externalLink">GitHub </a></li>
							<li><a href="index.html" title="Overview">Overview </a></li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="usage.html" title="Usage">Usage </a></li>
									<li><a href="extension.html" title="Extension">Extension </a></li>
									<li class="active"><a href="" title="Topologies">Topologies </a></li>
									<li><a href="configuration.html" title="Configuration">Configuration </a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="dropdown-submenu">
										<a href="project-info.html" title="Project Information">Project Information </a>
										<ul class="dropdown-menu">
											<li><a href="dependency-convergence.html" title="Dependency Convergence">Dependency Convergence </a></li>
											<li><a href="dependency-info.html" title="Dependency Information">Dependency Information </a></li>
											<li><a href="dependency-management.html" title="Dependency Management">Dependency Management </a></li>
											<li><a href="distribution-management.html" title="Distribution Management">Distribution Management </a></li>
											<li><a href="index.html" title="About">About </a></li>
											<li><a href="license.html" title="Licenses">Licenses </a></li>
											<li><a href="modules.html" title="Project Modules">Project Modules </a></li>
											<li><a href="plugin-management.html" title="Plugin Management">Plugin Management </a></li>
											<li><a href="plugins.html" title="Plugins">Plugins </a></li>
											<li><a href="team-list.html" title="Team">Team </a></li>
											<li><a href="source-repository.html" title="Source Code Management">Source Code Management </a></li>
											<li><a href="project-summary.html" title="Summary">Summary </a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
		</nav>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->

	
	
	<header class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="http://www.icfolson.com" id="bannerLeft"><img src="images/logo.jpg" alt="ICF Olson"></a>
				</div>
				<div class="pull-right">
										<a href="index.html" id="bannerRight"><h1>AEM Monitoring</h1></a>
					<p class="lead">Monitor your AEM applications</p>
				</div>
			</div>
		</div>


	
		</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<h1>Supported Topologies</h1> 
<p>AEM Monitoring supports 4 primary topologies withing an AEM environment: Multiple on-instance, single on-instance, single off-instance, and New Relic. The on-instance topologies use an <a class="externalLink" href="http://www.h2database.com">H2</a> database stored on the AEM server itself (and utilizing the machine’s own storage), whereas off-instance configurations can utilize several other database engines. MySQL, MariaDB, and Aurora have been tested and verified as off-instance database engines, but in theory any database supported by <a class="externalLink" href="https://www.jooq.org/">jOOQ</a> can be used. The New Relic configuration requires a <a class="externalLink" href="https://newrelic.com/">New Relic</a> subscription, and installation of the <a class="externalLink" href="https://docs.newrelic.com/docs/agents/java-agent">Java agent</a> on all instances. Setup and usage for each of the configurations is discussed below.</p> 
<p>It is worth noting that different environments can support different topologies without differing your code base. For example, a common setup might involve developers working with an H2 setup on their local instances, while higher environments are configured to use a New Relic topology.</p> 
<div class="section"> 
 <h2 id="Multiple_On-Instance">Multiple On-Instance</h2> 
 <p>Multiple on-instance topologies use a separate H2 database for each AEM instance. A service on author calls servlets on the publish instances to “reverse replicate” monitoring data to the author instance, where the AEM Monitoring console is accessed. The benefit of this topology is that data from the publish instance(s) will not be lost when the author instance is offline. The downside is that there is a small overhead on author and publish instances for the data replication.</p> 
 <p>This configuration can be set up by installing the <tt>aem-monitoring-ui</tt> and <tt>aem-monitoring-h2</tt> packages on each AEM instance. The H2 package contains configurations to start an H2 server and auto-initialize the schema, using port 8084 for author and 8085 for publish (to avoid conflicts in local setups). Additionally, serialization will need to be configured from publish to author. Go to <a class="externalLink" href="http://localhost:4502/apps/aem-monitoring/content/console.html">the console</a> on author and select the “Config” tab, creating client configurations for each publish instance.</p> 
 <p><img src="config.png" alt="Client Configuration Screen" /></p>
</div> 
<div class="section"> 
 <h2 id="Single_On-Instance">Single On-Instance</h2> 
 <p>A single on-instance topology will have data from all instance written directly to an H2 server running on author. This configuration eliminates the overhead of serializing data between instances, as the publish instances write directly to the single database via the H2 server managed by the author instance. The downside of this configuration is that data from the publish instances will be lost while the author instance is down.</p> 
 <p>To configure this topology, first remove all clients from the configuration screen (above), as publish instances will be writing directly to the database. Next, configure the “AEM Monitoring: H2 DB Server” service in the Sling console. Select “Externally Managed” and enter the author server address and port (8084 by default) to route publish data directly to the database managed by the author instance.</p> 
 <p><img src="h2-server.png" alt="H2 Server Configuration" /></p>
</div> 
<div class="section"> 
 <h2 id="Off-Instance">Off-Instance</h2> 
 <p>The off-instance topology writes all data to a single externally-managed database instance. This is the most stable and available configuration, but requires additional setup.</p> 
 <p>For MySQL-based DBs, <a href="../generic-db/src/main/resources/mysql-init.sql">this SQL script</a> can be used to initialize the monitoring database schema. Install both the <tt>aem-monitoring-ui</tt> and <tt>aem-monitoring-generic-db-installation</tt> packages. Create a “Day Commons JDBC Connection Pool” configuration for your database, using <tt>aem-monitoring</tt> as the datasource name, and ensuring that the JDBC driver for your database is installed in the OSGi environment. Finally, configure the “AEM Monitoring: Generic DB Connection Provider” service, entering the appropriate Dialect constant for jOOQ from <a class="externalLink" href="https://www.jooq.org/javadoc/3.6.2/org/jooq/SQLDialect.html">this page</a>.</p> 
 <p><img src="jdbc.png" alt="JDBC Configuration" /></p>
</div> 
<div class="section"> 
 <h2 id="New_Relic">New Relic</h2> 
 <p>The New Relic topology delegates all data storage and visualization/reporting to New Relic’s <a class="externalLink" href="https://newrelic.com/insights">Insights</a> services.</p>
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span4 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">User Guide</li>
						<li>
							<a href="usage.html" title="Usage">Usage </a>
						</li>
						<li>
							<a href="extension.html" title="Extension">Extension </a>
						</li>
						<li class="active">
							<a href="#" title="Topologies">Topologies </a>
						</li>
						<li>
							<a href="configuration.html" title="Configuration">Configuration </a>
						</li>
					</ul>
				</div>
				<div class="span5 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Project Documentation</li>
						<li>
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017 <a href="http://www.icfolson.com">ICF Olson</a>. All Rights Reserved.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='./js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="./js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	<script src="https://use.typekit.net/rya5bvi.js"></script><script>try{Typekit.load({ async: true });}catch(e){}</script>
	
	</body>
</html>
